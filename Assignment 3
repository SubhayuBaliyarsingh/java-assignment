//Q1

interface MyList<T>{
    void add (T element);
    void insert(T element, int index);
    T get(int index);
    void delete(int index);
    int size();
    boolean isEmpty();

}

//Q2
//Where we used the object array internally and resizing

class MyArrayList<T> implements MyList<T> {

    private Object[] data;
    private int size;
    private int capacity;

    MyArrayList() {
        capacity = 1;
        size = 0;
        data = new Object[capacity];
    }

    private void resize() {
        capacity *= 2;
        Object[] temp = new Object[capacity];
        for (int i = 0; i < size; i++) {
            temp[i] = data[i];
        }
        data = temp;
    }

    @Override
    public void add(T element) {
        if (size == capacity) {
            resize();
        }
        data[size++] = element;
    }

    @Override
    public void insert(T element, int index) {
        if (index < 0 || index > size) {
            throw new IndexOutOfBoundsException("Insert index out of range");
        }
        if (size == capacity) {
            resize();
        }
        for (int i = size; i > index; i--) {
            data[i] = data[i - 1];
        }
        data[index] = element;
        size++;
    }

    @Override
    @SuppressWarnings("unchecked")
    public T get(int index) {
        if (isEmpty()) {
            throw new IllegalStateException("List is empty");
        }
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("Get index out of range");
        }
        return (T) data[index];
    }

    @Override
    public void delete(int index) {
        if (isEmpty()) {
            throw new IllegalStateException("Cannot delete from empty list");
        }
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("Delete index out of range");
        }
        for (int i = index; i < size - 1; i++) {
            data[i] = data[i + 1];
        }
        data[--size] = null; 
    }

    @Override
    public int size() {
        return size;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }
}


//Q3 We have to create a singly linked list using node<T>

class MyLinkedList<T> implements MyList<T> {

    private static class Node<T> {
        T data;
        Node<T> next;

        Node(T data) {
            this.data = data;
            this.next = null;
        }
    }

    private Node<T> head;
    private int size;

    MyLinkedList() {
        head = null;
        size = 0;
    }

    @Override
    public void add(T element) {
        Node<T> newNode = new Node<>(element);
        if (head == null) {
            head = newNode;
        } else {
            Node<T> temp = head;
            while (temp.next != null) {
                temp = temp.next;
            }
            temp.next = newNode;
        }
        size++;
    }

    @Override
    public void insert(T element, int index) {
        if (index < 0 || index > size) {
            throw new IndexOutOfBoundsException("Insert index out of range");//Q5
        }

        Node<T> newNode = new Node<>(element);

        if (index == 0) {
            newNode.next = head;
            head = newNode;
        } else {
            Node<T> temp = head;
            for (int i = 0; i < index - 1; i++) {
                temp = temp.next;
            }
            newNode.next = temp.next;
            temp.next = newNode;
        }
        size++;
    }

    @Override
    public T get(int index) {
        if (isEmpty()) {
            throw new IllegalStateException("List is empty");//Q5
        }
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("Get index out of range");//Q5
        }

        Node<T> temp = head;
        for (int i = 0; i < index; i++) {
            temp = temp.next;
        }
        return temp.data;
    }

    @Override
    public void delete(int index) {
        if (isEmpty()) {
            throw new IllegalStateException("Cannot delete from empty list");//Q5
        }
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("Delete index out of range");//Q5
        }

        if (index == 0) {
            head = head.next;
        } else {
            Node<T> temp = head;
            for (int i = 0; i < index - 1; i++) {
                temp = temp.next;
            }
            temp.next = temp.next.next;
        }
        size--;
    }

    @Override
    public int size() {
        return size;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }
}


//Q4. So as we used generics same code will work for various data types as the core concept of generics is we can define the variable and use it as we like for different data types.

class Main {

    public static void main(String[] args) {

        
        MyList<Integer> intList = new MyArrayList<>();
        intList.add(10);
        intList.add(20);
        intList.insert(15, 1);

        
        MyList<String> stringList = new MyLinkedList<>();
        stringList.add("A");
        stringList.add("B");
        stringList.add("C");

        // Double List using Array implementation
        MyList<Double> doubleList = new MyArrayList<>();
        doubleList.add(1.5);
        doubleList.add(2.5);

        // Accessing elements
        System.out.println(intList.get(0));     // 10
        System.out.println(stringList.get(1));  // B
        System.out.println(doubleList.get(0));  // 1.5
    }
}


//Q6. Now we have to create a main class and we have to test both the implementation of (MyArrayList & MyLinkedList)

public class Main {

    static void printList(MyList<?> list) {
        for (int i = 0; i < list.size(); i++)
            System.out.print(list.get(i) + " ");
        System.out.println();
    }

    public static void main(String[] args) {
        
        MyList<Integer> list1 = new MyArrayList<>();
        MyList<String> list2 = new MyLinkedList<>();

        try {
            
            list1.add(10);
            list1.add(20);
            list1.insert(15, 1);
            list2.add("A");
            list2.add("B");
            list2.delete(0);
            printList(list1);
            printList(list2);
            
            list1.get(10);

        } catch (Exception e) {
            System.out.println("Exception caught: " + e.getClass().getSimpleName());
        } finally {
            System.out.println("Execution completed");
        }
    }
}

